{% extends 'app/base.html' %}
{% load i18n %}
{% load dict_sort %}
{% load staticfiles %}

{% block head-title %} - {% trans 'Apps' %} - {{ object.name }}{% endblock %}
{% block head %}
    <script defer="defer" src="{% static 'assets/js/img-slider.js' %}"></script>
{% endblock %}

{% block apps %}
    <div class="header-wrap">
        <h1>{{ object.name }}</h1>{% if object.featured %}<span class="tag featured">{% trans "Featured" %}</span>{% endif %}
    </div>
    <section class="app-gallery">
        {% if object.screenshots.all %}
            <div id="img-slider">
                <div class="img-strip">
                    {% for screenshot in object.screenshots.all %}
                        <div class="img" data-url="{{ screenshot.url }}"></div>
                    {% endfor %}
                </div>
            </div>
            <div class="img-slider-controls">
                <a class="control prev"><span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span> {% trans "Previous" %}</a>
                <a class="control next">{% trans "Next" %} <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span></a>
            </div>
        {% endif %}
    </section>
    <div class="row">
        <section class="app-description col-md-8">{% autoescape off %}{{ desc_markdown }}{% endautoescape %}</section>
        <section class="app-meta col-md-3">
            {% if object.created %}
            <h6>{% trans "Created" %}</h6>
            <p>{{ object.created }}</p>
            {% endif %}
            {% if object.last_modified %}
            <h6>{% trans "Last modified" %}</h6>
            <p>{{ object.last_modified }}</p>
            {% endif %}
            {% if object.owner %}
            <h6>{% trans "Owner" %}</h6>
            <p>
                {% if object.owner.get_fullname %}
                    {{ object.owner.get_fullname }}
                {% else %}
                    {{ object.owner.username }}
                {% endif %}
            </p>
            {% endif %}
            {% if object.co_maintainers.all %}
            <h6>{% trans "Maintainers" %}</h6>
            <ul class="list-inline">
                {% for a in object.co_maintainers.all %}
                    <li>{% if a.get_fullname %}
                            {{ a.get_fullname }}
                        {% else %}
                            {{ a.username }}
                        {% endif %}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </section>
    </div>
    <div class="row">
        <section class="app-download col-md-8">
            <h4>{% trans "Download" %}</h4>
            <table class="table">
                {% for platform_v, release in latest_releases_by_platform_v|dict_sort:'desc' %}
                    {% if release %}
                        <tr>
                            <td>Nextcloud {{ platform_v }}</td>
                            <td><a href="{{ release.download }}">Download latest ({{ release.version }})</a></td>
                            <td><a href="/app/{{ object.id }}/releases/?platform={{ platform_v }}">{% trans "Other releases" %}</a></td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </table>
        </section>
        <section class="app-resources col-md-4">
            <h4>{% trans "Resources" %}</h4>
            <p>
                {% if object.website %}
                    <a href="{{ object.website }}"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {% trans "Homepage" %}</a><br>
                {% endif %}
                {% if object.issue_tracker %}
                    <a href="{{ object.issue_tracker }}"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {% trans "Issue tracker" %}</a><br>
                {% endif %}
                {% if object.user_docs %}
                    <a href="{{ object.user_docs }}"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {% trans "User documentation" %}</a><br>
                {% endif %}
                {% if object.admin_docs %}
                    <a href="{{ object.admin_docs }}"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {% trans "Administration documentation" %}</a><br>
                {% endif %}
                {% if object.developer_docs %}
                    <a href="{{ object.developer_docs }}"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {% trans "Developer documentation" %}</a><br>
                {% endif %}
            </p>
        </section>
    </div>

{% endblock %}
